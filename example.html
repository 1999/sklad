<!DOCTYPE HTML>
<html>
<head>
    <title>Sklad example</title>
    <script src="./sklad.js"></script>
    <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        sklad.open("example" + Date.now(), {
            migration: {
                "1": function (callback) {
                    // @todo https://developer.mozilla.org/en-US/docs/IndexedDB/IDBDatabase#createObjectStore
                    var objStore = this.createObjectStore("obj_store", {autoIncrement: true});
                    // objStore.createIndex('foo', 'foo', {unique: true});
                    // this.transaction(objStoreName, "readwrite");
                    callback();
                }
            }
        }, function (err, database) {
            if (err)
                throw new Error(err);

            database.upsert("obj_store", {
                value: "Smth " + Date.now()
            }, function (err, key) {
                if (err)
                    throw err;
                
                database.upsert("obj_store", {
                    value: "Smth " + Date.now()
                }, function (err, key) {
                    if (err)
                        throw err;

                    // @see https://developer.mozilla.org/en-US/docs/IndexedDB/IDBKeyRange
                    database.get("obj_store", {
                        direction: sklad.PREVUNIQUE
                    }, function (err, data) {
                        console.log(JSON.stringify(data));
                    });
                });
            });
        });
    }, false);
    </script>
</head>
<body>

</body>
</html>