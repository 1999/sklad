!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.sklad=r():e.sklad=r()}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r){/**
	 * Copyright (c) 2013-2016 Dmitry Sorin <info@staypositive.ru>
	 * https://github.com/1999/sklad
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	 * THE SOFTWARE.
	 *
	 * @author Dmitry Sorin <info@staypositive.ru>
	 * @license http://www.opensource.org/licenses/mit-license.html MIT License
	 */
"use strict";function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=16*Math.random()|0,t="x"===e?r:3&r|8;return t.toString(16)})}function n(e,r){var n=Object.prototype.isPrototypeOf.call(f,r),o=n?r.value:r,i=n?r.key:void 0;if(null===e.keyPath)e.autoIncrement||void 0!==i||(i=t());else{if("object"!==("undefined"==typeof r?"undefined":a(r)))return!1;e.autoIncrement||void 0!==r[e.keyPath]||(r[e.keyPath]=t())}return i?[o,i]:[o]}function o(e){return e.every(function(e){return-1!==c.call(this.database.objectStoreNames,e)},this)}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};window.indexedDB||(window.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),window.IDBTransaction||(window.IDBTransaction=window.mozIDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction),window.IDBKeyRange||(window.IDBKeyRange=window.mozIDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange),window.IDBCursor||(window.IDBCursor=window.mozIDBCursor||window.webkitIDBCursor||window.msIDBCursor);var i=window.IDBTransaction.READ_ONLY||"readonly",s=window.IDBTransaction.READ_WRITE||"readwrite",u={};u.ASC=window.IDBCursor.NEXT||"next",u.ASC_UNIQUE=window.IDBCursor.NEXT_NO_DUPLICATE||"nextunique",u.DESC=window.IDBCursor.PREV||"prev",u.DESC_UNIQUE=window.IDBCursor.PREV_NO_DUPLICATE||"prevunique";var c=Array.prototype.indexOf,d="function"==typeof IDBObjectStore.prototype.getAll,f=Object.create(null),v={insert:function(){var e=this,r=1===arguments.length,t=r?Object.keys(arguments[0]):[arguments[0]],i=o.call(this,t);if(!i){var u=new DOMError("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(u)}var c=void 0;return r?c=arguments[0]:(c={},c[arguments[0]]=[arguments[1]]),new Promise(function(o,i){var u={},d=e.database.transaction(t,s),f=void 0;d.oncomplete=d.onerror=d.onabort=function(e){var n=f||e.target.error,a=!n&&"complete"===e.type;a?o(r?u:u[t[0]][0]):i(n),"error"===e.type&&e.preventDefault()};var v=function(e){for(var r=d.objectStore(e),t=function(t){var o=n(r,c[e][t]);if(!o)return f=new DOMError("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var a=void 0;try{a=r.add.apply(r,o)}catch(i){return f=i,"continue"}a.onsuccess=function(r){u[e]=u[e]||[],u[e][t]=r.target.result}},o=0;o<c[e].length;o++){var i=t(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":a(i)))return i.v}}};for(var l in c){var m=v(l);if("object"===("undefined"==typeof m?"undefined":a(m)))return m.v}})},upsert:function(){var e=this,r=1===arguments.length,t=r?Object.keys(arguments[0]):[arguments[0]],i=o.call(this,t);if(!i){var u=new DOMError("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(u)}var c=void 0;return r?c=arguments[0]:(c={},c[arguments[0]]=[arguments[1]]),new Promise(function(o,i){var u={},d=e.database.transaction(t,s),f=void 0;d.oncomplete=d.onerror=d.onabort=function(e){var n=f||e.target.error,a=!n&&"complete"===e.type;a?o(r?u:u[t[0]][0]):i(n),"error"===e.type&&e.preventDefault()};var v=function(e){for(var r=d.objectStore(e),t=function(t){var o=n(r,c[e][t]);if(!o)return f=new DOMError("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var a=void 0;try{a=r.put.apply(r,o)}catch(i){return f=i,"continue"}a.onsuccess=function(r){u[e]=u[e]||[],u[e][t]=r.target.result}},o=0;o<c[e].length;o++){var i=t(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":a(i)))return i.v}}};for(var l in c){var m=v(l);if("object"===("undefined"==typeof m?"undefined":a(m)))return m.v}})},"delete":function(){var e=this,r=1===arguments.length,t=r?Object.keys(arguments[0]):[arguments[0]],n=o.call(this,t);if(!n){var a=new DOMError("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(a)}var i=void 0;return r?i=arguments[0]:(i={},i[arguments[0]]=[arguments[1]]),new Promise(function(r,n){var o=e.database.transaction(t,s),a=void 0;o.oncomplete=o.onerror=o.onabort=function(e){var t=a||e.target.error;t?n(t):r(),"error"===e.type&&e.preventDefault()};var u=function(e){var r=o.objectStore(e);i[e].forEach(function(e){if(!a)try{r["delete"](e)}catch(t){a=t}})};for(var c in i)u(c)})},clear:function(e){var r=this;e=Array.isArray(e)?e:[e];var t=o.call(this,e);if(!t){var n=new DOMError("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(n)}return new Promise(function(t,n){var o=r.database.transaction(e,s),a=void 0;o.oncomplete=o.onerror=o.onabort=function(e){var r=a||e.target.error;r?n(r):t(),"error"===e.type&&e.preventDefault()},e.forEach(function(e){var r=o.objectStore(e);if(!a)try{r.clear()}catch(t){a=t}})})},get:function(){var e=this,r=2===arguments.length&&"object"===a(arguments[0])&&"function"==typeof arguments[1],t=r?Object.keys(arguments[0]):[arguments[0]],n=o.call(this,t);if(!n){var s=new DOMError("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(s)}var c={},f=void 0,v=void 0;return r?f=arguments[0]:(f={},f[arguments[0]]="function"==typeof arguments[1]?null:arguments[1]),t.forEach(function(e){c[e]=[]}),new Promise(function(n,o){var s=e.database.transaction(t,i);s.oncomplete=s.onerror=s.onabort=function(e){var a=v||e.target.error,i=!a&&"complete"===e.type;i?n(r?c:c[t[0]]):o(a),"error"===e.type&&e.preventDefault()};var l=function(e){var r=s.objectStore(e),t=f[e]||{},n=t.direction||u.ASC,o=t.range instanceof window.IDBKeyRange?t.range:null,a=!1,i=void 0;if(d&&(a=Object.keys(t).every(function(e){return"limit"===e||"range"===e})),t.index){if(!r.indexNames.contains(t.index))return v=new DOMError("NotFoundError","Object store "+r.name+" doesn't contain \""+t.index+'" index'),{v:void 0};try{i=r.index(t.index).openCursor(o,n)}catch(l){return v=l,{v:void 0}}}else if(a)try{r.getAll(o,t.limit||Number.POSITIVE_INFINITY).onsuccess=function(e){var r=e.target.result;console.log(JSON.stringify(r,null,"    "))}}catch(l){return v=l,{v:void 0}}else try{i=r.openCursor(o,n)}catch(l){return v=l,{v:void 0}}var m=!1;i.onsuccess=function(r){var n=r.target.result;if(n){if(t.offset&&!m)return m=!0,void n.advance(t.offset);c[e].push({key:n.key,value:n.value}),t.limit&&t.limit===c[e].length||n["continue"]()}}};for(var m in f){var w=l(m);if("object"===("undefined"==typeof w?"undefined":a(w)))return w.v}})},count:function(){var e=this,r=1===arguments.length&&"object"===a(arguments[0]),t=r?Object.keys(arguments[0]):[arguments[0]],n=void 0;r?n=arguments[0]:(n={},n[arguments[0]]="function"==typeof arguments[1]?null:arguments[1]);var s=o.call(this,t);if(!s){var u=new DOMError("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(u)}return new Promise(function(o,s){var u={},c=e.database.transaction(t,i),d=void 0,f=void 0;c.oncomplete=c.onerror=c.onabort=function(e){var n=f||e.target.error,a=!n&&"complete"===e.type;a?o(r?u:u[t[0]]):s(n),"error"===e.type&&e.preventDefault()};var v=function(e){var r=c.objectStore(e),t=n[e]||{},o=t.range instanceof window.IDBKeyRange?t.range:null;if(t.index){if(!r.indexNames.contains(t.index))return f=new DOMError("NotFoundError","Object store "+r.name+" doesn't contain \""+t.index+'" index'),{v:void 0};try{d=r.index(t.index).count(o)}catch(a){return f=a,{v:void 0}}}else try{d=r.count(o)}catch(a){return f=a,{v:void 0}}d.onsuccess=function(r){u[e]=r.target.result||0}};for(var l in n){var m=v(l);if("object"===("undefined"==typeof m?"undefined":a(m)))return m.v}})},close:function(){this.database.close(),delete this.database}};u.open=function(e){var r=arguments.length<=1||void 0===arguments[1]?{version:1}:arguments[1];return new Promise(function(t,n){if(!window.indexedDB)return void n(new DOMError("NotSupportedError","Your browser doesn't support IndexedDB"));var o=window.indexedDB.open(e,r.version),a=!1;o.onupgradeneeded=function(e){if(!a){r.migration=r.migration||{};for(var t=e.oldVersion+1;t<=e.newVersion;t++)r.migration[t]&&r.migration[t].call(this,this.result)}},o.onerror=function(e){a||(e.preventDefault(),n(e.target.error),a=!0)},o.onsuccess=function(i){if(!a){var s=this.result,c=parseInt(s.version||0,10);if("function"==typeof s.setVersion&&c<r.version){var d=s.setVersion(r.version);return d.onsuccess=function(a){var i=new Event("upgradeneeded");i.oldVersion=c,i.newVersion=r.version,o.onupgradeneeded.call({result:a.target.source},i),s.close(),u.open(e,r).then(t,n)},void(d.onerror=function(e){var r=e.target.errorMessage||e.target.webkitErrorMessage||e.target.mozErrorMessage||e.target.msErrorMessage||e.target.error.name;n(r)})}t(Object.create(v,{database:{configurable:!0,enumerable:!1,value:s,writable:!1}})),a=!0}},o.onblocked=function(r){a||(r.preventDefault(),n(new DOMError("InvalidStateError","Database "+e+" is blocked")),a=!0)}})},u.deleteDatabase=function(e){return new Promise(function(r,t){if(!window.indexedDB)return void t(new DOMError("NotSupportedError","Your browser doesn't support IndexedDB"));var n=window.indexedDB.deleteDatabase(e);n.onsuccess=n.onerror=n.onblocked=function(n){var o="blocked"===n.type?new DOMError("InvalidStateError","Database "+e+" is blocked"):n.target.error;o?t(o):r(),"success"!==n.type&&n.preventDefault()}})},u.keyValue=function(e,r){return Object.create(f,{key:{value:e,configurable:!1,writable:!1},value:{value:r,configurable:!1,writable:!1}})},r["default"]=u,e.exports=r["default"]}])});
//# sourceMappingURL=sklad.min.js.map