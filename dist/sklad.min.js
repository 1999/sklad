!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sklad=t():e.sklad=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){/**
	 * Copyright (c) 2013-2016 Dmitry Sorin <info@staypositive.ru>
	 * https://github.com/1999/sklad
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	 * THE SOFTWARE.
	 *
	 * @author Dmitry Sorin <info@staypositive.ru>
	 * @license http://www.opensource.org/licenses/mit-license.html MIT License
	 */
"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"===e?t:3&t|8;return r.toString(16)})}function a(e,t){var r=new Error(t);return r.name=e,r}function i(e){return e instanceof Error?e:a(e.name,e.message)}function u(e,t,r){var n=Object.prototype.isPrototypeOf.call(h,r),a=n?r.value:r,i=b.get(e).get(t.name),u=n?r.key:void 0,s=t.keyPath||i.keyPath,c=t.autoIncrement||i.autoIncrement;if(null===s)c||void 0!==u||(u=o());else{if("object"!==("undefined"==typeof r?"undefined":d(r)))return!1;c||void 0!==r[s]||(r[s]=o())}return u?[a,u]:[a]}function s(e){return e.every(function(e){return-1!==p.call(this.database.objectStoreNames,e)},this)}function c(e,t){var r=b.get(e.name),n=[];return t.forEach(function(t){if(!r.has(t)){var o=new Promise(function(n){var o=e.transaction([t],v);o.oncomplete=n,o.onabort=n;var a=o.objectStore(t);if(void 0!==a.autoIncrement)return void r.set(t,{autoIncrement:a.autoIncrement,keyPath:a.keyPath});var i=void 0;if(null!==a.keyPath)if(Array.isArray(a.keyPath))i=!1;else try{a.add({}),i=!0}catch(u){i=!1}else try{a.add("some value"),i=!0}catch(u){i=!1}r.set(t,{autoIncrement:i,keyPath:a.keyPath}),o.abort()});n.push(o)}}),Promise.all(n)}Object.defineProperty(t,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},f=r(1);window.indexedDB||(window.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),window.IDBTransaction||(window.IDBTransaction=window.mozIDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction),window.IDBKeyRange||(window.IDBKeyRange=window.mozIDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange),window.IDBCursor||(window.IDBCursor=window.mozIDBCursor||window.webkitIDBCursor||window.msIDBCursor);var l=window.IDBTransaction.READ_ONLY||"readonly",v=window.IDBTransaction.READ_WRITE||"readwrite",m={};m.ASC=window.IDBCursor.NEXT||"next",m.ASC_UNIQUE=window.IDBCursor.NEXT_NO_DUPLICATE||"nextunique",m.DESC=window.IDBCursor.PREV||"prev",m.DESC_UNIQUE=window.IDBCursor.PREV_NO_DUPLICATE||"prevunique";var p=Array.prototype.indexOf,y="function"==typeof IDBObjectStore.prototype.getAll,b=new Map,h=Object.create(null),g={insert:function(){var e=this,t=1===arguments.length,r=t?Object.keys(arguments[0]):[arguments[0]],o=s.call(this,r);if(!o){var l=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(l)}var m=void 0;return t?m=arguments[0]:(m={},m[arguments[0]]=[arguments[1]]),c(this.database,r).then(function(){return new Promise(function(o,s){var c={},l=void 0,p=void 0;try{l=e.database.transaction(r,v)}catch(y){return void("NotFoundError"===y.name?!function(){var t={};r.forEach(function(r){var o=e.insert(n({},r,Array.isArray(m[r])?m[r]:[m[r]])).then(function(e){return e[r]});t[r]=o}),f.all(t).then(o)["catch"](s)}():s(y))}l.oncomplete=l.onerror=l.onabort=function(e){var n=p||e.target.error,a=!n&&"complete"===e.type;a?o(t?c:c[r[0]][0]):s(i(n)),"error"===e.type&&e.preventDefault()};var b=function(t){for(var r=l.objectStore(t),n=function(n){var o=u(e.database.name,r,m[t][n]);if(!o)return p=a("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var i=void 0;try{i=r.add.apply(r,o)}catch(s){return p=s,"continue"}i.onsuccess=function(e){c[t]=c[t]||[],c[t][n]=e.target.result}},o=0;o<m[t].length;o++){var i=n(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":d(i)))return i.v}}};for(var h in m){var g=b(h);if("object"===("undefined"==typeof g?"undefined":d(g)))return g.v}})})},upsert:function(){var e=this,t=1===arguments.length,r=t?Object.keys(arguments[0]):[arguments[0]],o=s.call(this,r);if(!o){var l=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(l)}var m=void 0;return t?m=arguments[0]:(m={},m[arguments[0]]=[arguments[1]]),c(this.database,r).then(function(){return new Promise(function(o,s){var c={},l=void 0,p=void 0;try{l=e.database.transaction(r,v)}catch(y){return void("NotFoundError"===y.name?!function(){var t={};r.forEach(function(r){var o=e.upsert(n({},r,Array.isArray(m[r])?m[r]:[m[r]])).then(function(e){return e[r]});t[r]=o}),f.all(t).then(o)["catch"](s)}():s(y))}l.oncomplete=l.onerror=l.onabort=function(e){var n=p||e.target.error,a=!n&&"complete"===e.type;a?o(t?c:c[r[0]][0]):s(i(n)),"error"===e.type&&e.preventDefault()};var b=function(t){for(var r=l.objectStore(t),n=function(n){var o=u(e.database.name,r,m[t][n]);if(!o)return p=a("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var i=void 0;try{i=r.put.apply(r,o)}catch(s){return p=s,"continue"}i.onsuccess=function(e){c[t]=c[t]||[],c[t][n]=e.target.result}},o=0;o<m[t].length;o++){var i=n(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":d(i)))return i.v}}};for(var h in m){var g=b(h);if("object"===("undefined"==typeof g?"undefined":d(g)))return g.v}})})},"delete":function(){var e=this,t=1===arguments.length,r=t?Object.keys(arguments[0]):[arguments[0]],n=s.call(this,r);if(!n){var o=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(o)}var u=void 0;return t?u=arguments[0]:(u={},u[arguments[0]]=[arguments[1]]),new Promise(function(t,n){var o=void 0,a=void 0;try{o=e.database.transaction(r,v)}catch(s){if("NotFoundError"===s.name){var c=r.map(function(t){return e["delete"](t,u[t])});Promise.all(c).then(function(){return t()})["catch"](n)}else n(s);return}o.oncomplete=o.onerror=o.onabort=function(e){var r=a||e.target.error;r?n(i(r)):t(),"error"===e.type&&e.preventDefault()};var d=function(e){var t=o.objectStore(e);u[e].forEach(function(e){if(!a)try{t["delete"](e)}catch(r){a=r}})};for(var f in u)d(f)})},clear:function(e){var t=this;e=Array.isArray(e)?e:[e];var r=s.call(this,e);if(!r){var n=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(n)}return new Promise(function(r,n){var o=void 0,a=void 0;try{o=t.database.transaction(e,v)}catch(u){if("NotFoundError"===u.name){var s=e.map(function(e){return t.clear([e])});Promise.all(s).then(function(){return r()})["catch"](n)}else n(u);return}o.oncomplete=o.onerror=o.onabort=function(e){var t=a||e.target.error;t?n(i(t)):r(),"error"===e.type&&e.preventDefault()},e.forEach(function(e){var t=o.objectStore(e);if(!a)try{t.clear()}catch(r){a=r}})})},get:function(){var e=this,t=2===arguments.length&&"object"===d(arguments[0])&&"function"==typeof arguments[1],r=t?Object.keys(arguments[0]):[arguments[0]],n=s.call(this,r);if(!n){var o=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(o)}var u={},c=void 0,v=void 0;return t?c=arguments[0]:(c={},c[arguments[0]]="function"==typeof arguments[1]?null:arguments[1]),r.forEach(function(e){u[e]=[]}),new Promise(function(n,o){var s=void 0;try{s=e.database.transaction(r,l)}catch(p){return void("NotFoundError"===p.name?!function(){var t={};r.forEach(function(r){var n=e.get(r,c[r]);t[r]=n}),f.all(t).then(n)["catch"](o)}():o(p))}s.oncomplete=s.onerror=s.onabort=function(e){var a=v||e.target.error,s=!a&&"complete"===e.type;s?n(t?u:u[r[0]]):o(i(a)),"error"===e.type&&e.preventDefault()};var b=function(e){var t=s.objectStore(e),r=c[e]||{},n=r.direction||m.ASC,o=r.range instanceof window.IDBKeyRange?r.range:null,i=!1,d=void 0;if(y&&(i=Object.keys(r).every(function(e){return"limit"===e||"range"===e})),r.index){if(!t.indexNames.contains(r.index))return v=a("NotFoundError","Object store "+t.name+" doesn't contain \""+r.index+'" index'),{v:void 0};try{d=t.index(r.index).openCursor(o,n)}catch(f){return v=f,{v:void 0}}}else try{d=t.openCursor(o,n)}catch(f){return v=f,{v:void 0}}var l=!1;d.onsuccess=function(t){var n=t.target.result;if(n){if(r.offset&&!l)return l=!0,void n.advance(r.offset);u[e].push({key:n.key,value:n.value}),r.limit&&r.limit===u[e].length||n["continue"]()}}};for(var h in c){var g=b(h);if("object"===("undefined"==typeof g?"undefined":d(g)))return g.v}})},count:function(){var e=this,t=1===arguments.length&&"object"===d(arguments[0]),r=t?Object.keys(arguments[0]):[arguments[0]],n=void 0;t?n=arguments[0]:(n={},n[arguments[0]]="function"==typeof arguments[1]?null:arguments[1]);var o=s.call(this,r);if(!o){var u=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(u)}return new Promise(function(o,u){var s={},c=void 0,v=void 0,m=void 0;try{c=e.database.transaction(r,l)}catch(p){return void("NotFoundError"===p.name?!function(){var t={};r.forEach(function(r){var o=e.count(r,n[r]);t[r]=o}),f.all(t).then(o)["catch"](u)}():u(p))}c.oncomplete=c.onerror=c.onabort=function(e){var n=m||e.target.error,a=!n&&"complete"===e.type;a?o(t?s:s[r[0]]):u(i(n)),"error"===e.type&&e.preventDefault()};var y=function(e){var t=c.objectStore(e),r=n[e]||{},o=r.range instanceof window.IDBKeyRange?[r.range]:[];if(r.index){if(!t.indexNames.contains(r.index))return m=a("NotFoundError","Object store "+t.name+" doesn't contain \""+r.index+'" index'),{v:void 0};try{var i=t.index(r.index);v=i.count.apply(i,o)}catch(u){return m=u,{v:void 0}}}else try{v=t.count.apply(t,o)}catch(u){return m=u,{v:void 0}}v.onsuccess=function(t){s[e]=t.target.result||0}};for(var b in n){var h=y(b);if("object"===("undefined"==typeof h?"undefined":d(h)))return h.v}})},close:function(){this.database.close(),delete this.database}};m.open=function(e){var t=arguments.length<=1||void 0===arguments[1]?{version:1}:arguments[1];return new Promise(function(r,n){if(!window.indexedDB)return void n(a("NotSupportedError","Your browser doesn't support IndexedDB"));var o=window.indexedDB.open(e,t.version),u=!1;o.onupgradeneeded=function(e){if(!u){t.migration=t.migration||{};for(var r=e.oldVersion+1;r<=e.newVersion;r++)t.migration[r]&&t.migration[r].call(this,this.result)}},o.onerror=function(e){u||(e.preventDefault(),n(i(e.target.error)),u=!0)},o.onsuccess=function(a){if(!u){var s=this.result,c=parseInt(s.version||0,10);if("function"==typeof s.setVersion&&c<t.version){var d=s.setVersion(t.version);return d.onsuccess=function(a){var i=new Event("upgradeneeded");i.oldVersion=c,i.newVersion=t.version,o.onupgradeneeded.call({result:a.target.source},i),s.close(),m.open(e,t).then(r,n)},void(d.onerror=function(e){var t=e.target.errorMessage||e.target.webkitErrorMessage||e.target.mozErrorMessage||e.target.msErrorMessage||e.target.error.name;n(i(t))})}b.set(e,new Map),r(Object.create(g,{database:{configurable:!0,enumerable:!1,value:s,writable:!1}})),u=!0}},o.onblocked=function(t){u||(t.preventDefault(),n(a("InvalidStateError","Database "+e+" is blocked")),u=!0)}})},m.deleteDatabase=function(e){return new Promise(function(t,r){if(!window.indexedDB)return void r(a("NotSupportedError","Your browser doesn't support IndexedDB"));var n=window.indexedDB.deleteDatabase(e);n.onsuccess=n.onerror=n.onblocked=function(n){var o="blocked"===n.type?a("InvalidStateError","Database "+e+" is blocked"):n.target.error;o?r(i(o)):t(),"success"!==n.type&&n.preventDefault()}})},m.keyValue=function(e,t){return Object.create(h,{key:{value:e,configurable:!1,writable:!1},value:{value:t,configurable:!1,writable:!1}})},t["default"]=m,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(e){function t(){return r(this,t),n(this,Object.getPrototypeOf(t).apply(this,arguments))}return o(t,e),i(t,[{key:"spread",value:function(e,t){var r=function(t){return Array.isArray(t)?e.apply(null,t):void 0};return this.then(r,t)}}]),t}(Promise);u.all=function(e){return arguments.length>1||"object"!==("undefined"==typeof e?"undefined":a(e))?Promise.all.apply(Promise,arguments):new u(function(t,r){var n=Array.isArray(e),o=void 0,a=void 0;n?o=e:(a=Object.keys(e),o=a.map(function(t){return e[t]})),Promise.all(o).then(function(e){var r=void 0;r=n?e:e.reduce(function(e,t,r){return e[a[r]]=t,e},{}),t(r)})["catch"](r)})},e.exports=u}])});
//# sourceMappingURL=sklad.min.js.map