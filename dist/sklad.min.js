!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sklad=t():e.sklad=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){/**
	 * Copyright (c) 2013-2016 Dmitry Sorin <info@staypositive.ru>
	 * https://github.com/1999/sklad
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	 * THE SOFTWARE.
	 *
	 * @author Dmitry Sorin <info@staypositive.ru>
	 * @license http://www.opensource.org/licenses/mit-license.html MIT License
	 */
"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"===e?t:3&t|8;return r.toString(16)})}function a(e,t){var r=new Error(t);return r.name=e,r}function i(e){return e instanceof Error?e:a(e.name,e.message)}function u(e,t,r){var n=Object.prototype.isPrototypeOf.call(m,r),a=n?r.value:r,i=h.get(e).get(t.name),u=n?r.key:void 0,c=t.keyPath||i.keyPath,s=t.autoIncrement||i.autoIncrement;if(null===c)s||void 0!==u||(u=o());else{if("object"!==("undefined"==typeof r?"undefined":d(r)))return!1;s||void 0!==r[c]||(r[c]=o())}return u?[a,u]:[a]}function c(e){return e.every(function(e){return-1!==y.call(this.database.objectStoreNames,e)},this)}function s(e,t){var r=h.get(e.name),n=[];return t.forEach(function(t){if(!r.has(t)){var o=new Promise(function(n){var o=e.transaction([t],v);o.oncomplete=n,o.onabort=n;var a=o.objectStore(t);if(void 0!==a.autoIncrement)return void r.set(t,{autoIncrement:a.autoIncrement,keyPath:a.keyPath});var i=void 0;if(null!==a.keyPath)if(Array.isArray(a.keyPath))i=!1;else try{a.add({}),i=!0}catch(u){i=!1}else try{a.add("some value"),i=!0}catch(u){i=!1}r.set(t,{autoIncrement:i,keyPath:a.keyPath}),o.abort()});n.push(o)}}),Promise.all(n)}Object.defineProperty(t,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},f=r(1);window.indexedDB||(window.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),window.IDBTransaction||(window.IDBTransaction=window.mozIDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction),window.IDBKeyRange||(window.IDBKeyRange=window.mozIDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange),window.IDBCursor||(window.IDBCursor=window.mozIDBCursor||window.webkitIDBCursor||window.msIDBCursor);var l=window.IDBTransaction.READ_ONLY||"readonly",v=window.IDBTransaction.READ_WRITE||"readwrite",p={};p.ASC=window.IDBCursor.NEXT||"next",p.ASC_UNIQUE=window.IDBCursor.NEXT_NO_DUPLICATE||"nextunique",p.DESC=window.IDBCursor.PREV||"prev",p.DESC_UNIQUE=window.IDBCursor.PREV_NO_DUPLICATE||"prevunique";var y=Array.prototype.indexOf,b="function"==typeof IDBObjectStore.prototype.getAll&&"function"==typeof IDBObjectStore.prototype.getAllKeys,h=new Map,m=Object.create(null),w={insert:function(){var e=this,t=1===arguments.length,r=t?Object.keys(arguments[0]):[arguments[0]],o=c.call(this,r);if(!o){var l=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(l)}var p=void 0;return t?p=arguments[0]:(p={},p[arguments[0]]=[arguments[1]]),s(this.database,r).then(function(){return new Promise(function(o,c){var s={},l=void 0,y=void 0;try{l=e.database.transaction(r,v)}catch(b){return void("NotFoundError"===b.name?!function(){var t={};r.forEach(function(r){var o=e.insert(n({},r,Array.isArray(p[r])?p[r]:[p[r]])).then(function(e){return e[r]});t[r]=o}),f.all(t).then(o)["catch"](c)}():c(b))}l.oncomplete=l.onerror=l.onabort=function(e){var n=y||e.target.error,a=!n&&"complete"===e.type;a?o(t?s:s[r[0]][0]):c(i(n)),"error"===e.type&&e.preventDefault()};var h=function(t){for(var r=l.objectStore(t),n=function(n){var o=u(e.database.name,r,p[t][n]);if(!o)return y=a("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var i=void 0;try{i=r.add.apply(r,o)}catch(c){return y=c,"continue"}i.onsuccess=function(e){s[t]=s[t]||[],s[t][n]=e.target.result}},o=0;o<p[t].length;o++){var i=n(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":d(i)))return i.v}}};for(var m in p){var w=h(m);if("object"===("undefined"==typeof w?"undefined":d(w)))return w.v}})})},upsert:function(){var e=this,t=1===arguments.length,r=t?Object.keys(arguments[0]):[arguments[0]],o=c.call(this,r);if(!o){var l=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(l)}var p=void 0;return t?p=arguments[0]:(p={},p[arguments[0]]=[arguments[1]]),s(this.database,r).then(function(){return new Promise(function(o,c){var s={},l=void 0,y=void 0;try{l=e.database.transaction(r,v)}catch(b){return void("NotFoundError"===b.name?!function(){var t={};r.forEach(function(r){var o=e.upsert(n({},r,Array.isArray(p[r])?p[r]:[p[r]])).then(function(e){return e[r]});t[r]=o}),f.all(t).then(o)["catch"](c)}():c(b))}l.oncomplete=l.onerror=l.onabort=function(e){var n=y||e.target.error,a=!n&&"complete"===e.type;a?o(t?s:s[r[0]][0]):c(i(n)),"error"===e.type&&e.preventDefault()};var h=function(t){for(var r=l.objectStore(t),n=function(n){var o=u(e.database.name,r,p[t][n]);if(!o)return y=a("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var i=void 0;try{i=r.put.apply(r,o)}catch(c){return y=c,"continue"}i.onsuccess=function(e){s[t]=s[t]||[],s[t][n]=e.target.result}},o=0;o<p[t].length;o++){var i=n(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":d(i)))return i.v}}};for(var m in p){var w=h(m);if("object"===("undefined"==typeof w?"undefined":d(w)))return w.v}})})},"delete":function(){var e=this,t=1===arguments.length,r=t?Object.keys(arguments[0]):[arguments[0]],n=c.call(this,r);if(!n){var o=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(o)}var u=void 0;return t?u=arguments[0]:(u={},u[arguments[0]]=[arguments[1]]),new Promise(function(t,n){var o=void 0,a=void 0;try{o=e.database.transaction(r,v)}catch(c){if("NotFoundError"===c.name){var s=r.map(function(t){return e["delete"](t,u[t])});Promise.all(s).then(function(){return t()})["catch"](n)}else n(c);return}o.oncomplete=o.onerror=o.onabort=function(e){var r=a||e.target.error;r?n(i(r)):t(),"error"===e.type&&e.preventDefault()};var d=function(e){var t=o.objectStore(e);u[e].forEach(function(e){if(!a)try{t["delete"](e)}catch(r){a=r}})};for(var f in u)d(f)})},clear:function(e){var t=this;e=Array.isArray(e)?e:[e];var r=c.call(this,e);if(!r){var n=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(n)}return new Promise(function(r,n){var o=void 0,a=void 0;try{o=t.database.transaction(e,v)}catch(u){if("NotFoundError"===u.name){var c=e.map(function(e){return t.clear([e])});Promise.all(c).then(function(){return r()})["catch"](n)}else n(u);return}o.oncomplete=o.onerror=o.onabort=function(e){var t=a||e.target.error;t?n(i(t)):r(),"error"===e.type&&e.preventDefault()},e.forEach(function(e){var t=o.objectStore(e);if(!a)try{t.clear()}catch(r){a=r}})})},get:function(){var e=this,t=2===arguments.length&&"object"===d(arguments[0])&&"function"==typeof arguments[1],r=t?Object.keys(arguments[0]):[arguments[0]],n=c.call(this,r);if(!n){var o=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(o)}var u={},s=void 0,v=void 0;return t?s=arguments[0]:(s={},s[arguments[0]]="function"==typeof arguments[1]?null:arguments[1]),r.forEach(function(e){u[e]=[]}),new Promise(function(n,o){var c=void 0;try{c=e.database.transaction(r,l)}catch(y){return void("NotFoundError"===y.name?!function(){var t={};r.forEach(function(r){var n=e.get(r,s[r]);t[r]=n}),f.all(t).then(n)["catch"](o)}():o(y))}c.oncomplete=c.onerror=c.onabort=function(e){var a=v||e.target.error,c=!a&&"complete"===e.type;c?n(t?u:u[r[0]]):o(i(a)),"error"===e.type&&e.preventDefault()};var h=function(e){var t=c.objectStore(e),r=s[e]||{},n=r.direction||p.ASC,o=r.range instanceof window.IDBKeyRange?r.range:null,i=!1,f=void 0;if(b&&(i=Object.keys(r).every(function(e){return"index"!==e&&"direction"!==e})),r.index){if(!t.indexNames.contains(r.index))return v=a("NotFoundError","Object store "+t.name+" doesn't contain \""+r.index+'" index'),{v:void 0};try{f=t.index(r.index).openCursor(o,n)}catch(l){return v=l,{v:void 0}}}else if(i){var y=function(){var n=[o],a=0;r.limit&&(n.push(r.limit),r.offset&&(n[1]+=r.offset,a=r.offset));try{t.getAll.apply(t,n).onsuccess=function(t){var r=t.target.result;r.forEach(function(t,r){if(!(a>r)){var n=r-a;u[e][n]=u[e][n]||{},u[e][n].value=t}})},t.getAllKeys.apply(t,n).onsuccess=function(t){var r=t.target.result;r.forEach(function(t,r){if(!(a>r)){var n=r-a;u[e][n]=u[e][n]||{},u[e][n].key=t}})}}catch(i){v=i}finally{return{v:{v:void 0}}}}();if("object"===("undefined"==typeof y?"undefined":d(y)))return y.v}else try{f=t.openCursor(o,n)}catch(l){return v=l,{v:void 0}}var h=!1;f.onsuccess=function(t){var n=t.target.result;if(n){if(r.offset&&!h)return h=!0,void n.advance(r.offset);u[e].push({key:n.key,value:n.value}),r.limit&&r.limit===u[e].length||n["continue"]()}}};for(var m in s){var w=h(m);if("object"===("undefined"==typeof w?"undefined":d(w)))return w.v}})},count:function(){var e=this,t=1===arguments.length&&"object"===d(arguments[0]),r=t?Object.keys(arguments[0]):[arguments[0]],n=void 0;t?n=arguments[0]:(n={},n[arguments[0]]="function"==typeof arguments[1]?null:arguments[1]);var o=c.call(this,r);if(!o){var u=a("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(u)}return new Promise(function(o,u){var c={},s=void 0,v=void 0,p=void 0;try{s=e.database.transaction(r,l)}catch(y){return void("NotFoundError"===y.name?!function(){var t={};r.forEach(function(r){var o=e.count(r,n[r]);t[r]=o}),f.all(t).then(o)["catch"](u)}():u(y))}s.oncomplete=s.onerror=s.onabort=function(e){var n=p||e.target.error,a=!n&&"complete"===e.type;a?o(t?c:c[r[0]]):u(i(n)),"error"===e.type&&e.preventDefault()};var b=function(e){var t=s.objectStore(e),r=n[e]||{},o=r.range instanceof window.IDBKeyRange?[r.range]:[];if(r.index){if(!t.indexNames.contains(r.index))return p=a("NotFoundError","Object store "+t.name+" doesn't contain \""+r.index+'" index'),{v:void 0};try{var i=t.index(r.index);v=i.count.apply(i,o)}catch(u){return p=u,{v:void 0}}}else try{v=t.count.apply(t,o)}catch(u){return p=u,{v:void 0}}v.onsuccess=function(t){c[e]=t.target.result||0}};for(var h in n){var m=b(h);if("object"===("undefined"==typeof m?"undefined":d(m)))return m.v}})},close:function(){this.database.close(),delete this.database}};p.open=function(e){var t=arguments.length<=1||void 0===arguments[1]?{version:1}:arguments[1];return new Promise(function(r,n){if(!window.indexedDB)return void n(a("NotSupportedError","Your browser doesn't support IndexedDB"));var o=window.indexedDB.open(e,t.version),u=!1;o.onupgradeneeded=function(e){if(!u){t.migration=t.migration||{};for(var r=e.oldVersion+1;r<=e.newVersion;r++)t.migration[r]&&t.migration[r].call(this,this.result)}},o.onerror=function(e){u||(e.preventDefault(),n(i(e.target.error)),u=!0)},o.onsuccess=function(a){if(!u){var c=this.result,s=parseInt(c.version||0,10);if("function"==typeof c.setVersion&&s<t.version){var d=c.setVersion(t.version);return d.onsuccess=function(a){var i=new Event("upgradeneeded");i.oldVersion=s,i.newVersion=t.version,o.onupgradeneeded.call({result:a.target.source},i),c.close(),p.open(e,t).then(r,n)},void(d.onerror=function(e){var t=e.target.errorMessage||e.target.webkitErrorMessage||e.target.mozErrorMessage||e.target.msErrorMessage||e.target.error.name;n(i(t))})}h.set(e,new Map),r(Object.create(w,{database:{configurable:!0,enumerable:!1,value:c,writable:!1}})),u=!0}},o.onblocked=function(t){u||(t.preventDefault(),n(a("InvalidStateError","Database "+e+" is blocked")),u=!0)}})},p.deleteDatabase=function(e){return new Promise(function(t,r){if(!window.indexedDB)return void r(a("NotSupportedError","Your browser doesn't support IndexedDB"));var n=window.indexedDB.deleteDatabase(e);n.onsuccess=n.onerror=n.onblocked=function(n){var o="blocked"===n.type?a("InvalidStateError","Database "+e+" is blocked"):n.target.error;o?r(i(o)):t(),"success"!==n.type&&n.preventDefault()}})},p.keyValue=function(e,t){return Object.create(m,{key:{value:e,configurable:!1,writable:!1},value:{value:t,configurable:!1,writable:!1}})},t["default"]=p,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(){return r(this,t),n(this,Object.getPrototypeOf(t).apply(this,arguments))}return o(t,e),u(t,[{key:"spread",value:function(e,t){function r(t){return Array.isArray(t)?e.apply(void 0,a(t)):void 0}return this.then(r,t)}}]),t}(Promise);c.all=function(e){return arguments.length>1||"object"!==("undefined"==typeof e?"undefined":i(e))?Promise.all.apply(Promise,arguments):new c(function(t,r){var n=Array.isArray(e),o=void 0,a=void 0;n?o=e:(a=Object.keys(e),o=a.map(function(t){return e[t]})),Promise.all(o).then(function(e){var r=void 0;r=n?e:e.reduce(function(e,t,r){return e[a[r]]=t,e},{}),t(r)})["catch"](r)})},t["default"]=c,e.exports=t["default"]}])});
//# sourceMappingURL=sklad.min.js.map