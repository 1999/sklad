!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.sklad=r():e.sklad=r()}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){/**
	 * Copyright (c) 2013-2016 Dmitry Sorin <info@staypositive.ru>
	 * https://github.com/1999/sklad
	 *
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	 * THE SOFTWARE.
	 *
	 * @author Dmitry Sorin <info@staypositive.ru>
	 * @license http://www.opensource.org/licenses/mit-license.html MIT License
	 */
"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r,t){var n=Object.prototype.isPrototypeOf.call(E,t),o=n?t.value:t,a=w.get(e).get(r.name),i=n?t.key:void 0,u=r.keyPath||a.keyPath,s=r.autoIncrement||a.autoIncrement;if(null===u)s||void 0!==i||(i=(0,l["default"])());else{if("object"!==("undefined"==typeof t?"undefined":c(t)))return!1;s||void 0!==t[u]||(t[u]=(0,l["default"])())}return i?[o,i]:[o]}function i(e){return e.every(function(e){return-1!==h.call(this.database.objectStoreNames,e)},this)}function u(e,r){var t=w.get(e.name),n=[];return r.forEach(function(r){if(!t.has(r)){var o=new Promise(function(n){var o=e.transaction([r],y);o.oncomplete=n,o.onabort=n;var a=o.objectStore(r);if(void 0!==a.autoIncrement)return void t.set(r,{autoIncrement:a.autoIncrement,keyPath:a.keyPath});var i=void 0;if(null!==a.keyPath)if(Array.isArray(a.keyPath))i=!1;else try{a.add({}),i=!0}catch(u){i=!1}else try{a.add("some value"),i=!0}catch(u){i=!1}t.set(r,{autoIncrement:i,keyPath:a.keyPath}),o.abort()});n.push(o)}}),Promise.all(n)}Object.defineProperty(r,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=t(1),d=n(s),f=t(2),l=n(f),v=t(3);window.indexedDB||(window.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),window.IDBTransaction||(window.IDBTransaction=window.mozIDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction),window.IDBKeyRange||(window.IDBKeyRange=window.mozIDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange),window.IDBCursor||(window.IDBCursor=window.mozIDBCursor||window.webkitIDBCursor||window.msIDBCursor);var p=window.IDBTransaction.READ_ONLY||"readonly",y=window.IDBTransaction.READ_WRITE||"readwrite",b={};b.ASC=window.IDBCursor.NEXT||"next",b.ASC_UNIQUE=window.IDBCursor.NEXT_NO_DUPLICATE||"nextunique",b.DESC=window.IDBCursor.PREV||"prev",b.DESC_UNIQUE=window.IDBCursor.PREV_NO_DUPLICATE||"prevunique";var h=Array.prototype.indexOf,m="function"==typeof IDBObjectStore.prototype.getAll&&"function"==typeof IDBObjectStore.prototype.getAllKeys,w=new Map,E=Object.create(null),g={insert:function(){var e=this,r=1===arguments.length,t=r?Object.keys(arguments[0]):[arguments[0]],n=i.call(this,t);if(!n){var s=(0,v.createError)("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(s)}var f=void 0;return r?f=arguments[0]:(f={},f[arguments[0]]=[arguments[1]]),u(this.database,t).then(function(){return new Promise(function(n,i){var u={},s=void 0,l=void 0;try{s=e.database.transaction(t,y)}catch(p){return void("NotFoundError"===p.name?!function(){var r={};t.forEach(function(t){var n=e.insert(o({},t,Array.isArray(f[t])?f[t]:[f[t]])).then(function(e){return e[t]});r[t]=n}),d["default"].all(r).then(n)["catch"](i)}():i(p))}s.oncomplete=s.onerror=s.onabort=function(e){var o=l||e.target.error,a=!o&&"complete"===e.type;a?n(r?u:u[t[0]][0]):i((0,v.ensureError)(o)),"error"===e.type&&e.preventDefault()};var b=function(r){for(var t=s.objectStore(r),n=function(n){var o=a(e.database.name,t,f[r][n]);if(!o)return l=(0,v.createError)("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var i=void 0;try{i=t.add.apply(t,o)}catch(c){return l=c,"continue"}i.onsuccess=function(e){u[r]=u[r]||[],u[r][n]=e.target.result}},o=0;o<f[r].length;o++){var i=n(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":c(i)))return i.v}}};for(var h in f){var m=b(h);if("object"===("undefined"==typeof m?"undefined":c(m)))return m.v}})})},upsert:function(){var e=this,r=1===arguments.length,t=r?Object.keys(arguments[0]):[arguments[0]],n=i.call(this,t);if(!n){var s=(0,v.createError)("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(s)}var f=void 0;return r?f=arguments[0]:(f={},f[arguments[0]]=[arguments[1]]),u(this.database,t).then(function(){return new Promise(function(n,i){var u={},s=void 0,l=void 0;try{s=e.database.transaction(t,y)}catch(p){return void("NotFoundError"===p.name?!function(){var r={};t.forEach(function(t){var n=e.upsert(o({},t,Array.isArray(f[t])?f[t]:[f[t]])).then(function(e){return e[t]});r[t]=n}),d["default"].all(r).then(n)["catch"](i)}():i(p))}s.oncomplete=s.onerror=s.onabort=function(e){var o=l||e.target.error,a=!o&&"complete"===e.type;a?n(r?u:u[t[0]][0]):i((0,v.ensureError)(o)),"error"===e.type&&e.preventDefault()};var b=function(r){for(var t=s.objectStore(r),n=function(n){var o=a(e.database.name,t,f[r][n]);if(!o)return l=(0,v.createError)("InvalidStateError","You must supply objects to be saved in the object store with set keyPath"),{v:{v:void 0}};var i=void 0;try{i=t.put.apply(t,o)}catch(c){return l=c,"continue"}i.onsuccess=function(e){u[r]=u[r]||[],u[r][n]=e.target.result}},o=0;o<f[r].length;o++){var i=n(o);switch(i){case"continue":continue;default:if("object"===("undefined"==typeof i?"undefined":c(i)))return i.v}}};for(var h in f){var m=b(h);if("object"===("undefined"==typeof m?"undefined":c(m)))return m.v}})})},"delete":function(){var e=this,r=1===arguments.length,t=r?Object.keys(arguments[0]):[arguments[0]],n=i.call(this,t);if(!n){var o=(0,v.createError)("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(o)}var a=void 0;return r?a=arguments[0]:(a={},a[arguments[0]]=[arguments[1]]),new Promise(function(r,n){var o=void 0,i=void 0;try{o=e.database.transaction(t,y)}catch(u){if("NotFoundError"===u.name){var c=t.map(function(r){return e["delete"](r,a[r])});Promise.all(c).then(function(){return r()})["catch"](n)}else n(u);return}o.oncomplete=o.onerror=o.onabort=function(e){var t=i||e.target.error;t?n((0,v.ensureError)(t)):r(),"error"===e.type&&e.preventDefault()};var s=function(e){var r=o.objectStore(e);a[e].forEach(function(e){if(!i)try{r["delete"](e)}catch(t){i=t}})};for(var d in a)s(d)})},clear:function(e){var r=this;e=Array.isArray(e)?e:[e];var t=i.call(this,e);if(!t){var n=(0,v.createError)("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(n)}return new Promise(function(t,n){var o=void 0,a=void 0;try{o=r.database.transaction(e,y)}catch(i){if("NotFoundError"===i.name){var u=e.map(function(e){return r.clear([e])});Promise.all(u).then(function(){return t()})["catch"](n)}else n(i);return}o.oncomplete=o.onerror=o.onabort=function(e){var r=a||e.target.error;r?n((0,v.ensureError)(r)):t(),"error"===e.type&&e.preventDefault()},e.forEach(function(e){var r=o.objectStore(e);if(!a)try{r.clear()}catch(t){a=t}})})},get:function(){var e=this,r=1===arguments.length&&"object"===c(arguments[0]),t=r?Object.keys(arguments[0]):[arguments[0]],n=i.call(this,t);if(!n){var o=(0,v.createError)("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(o)}var a={},u=void 0,s=void 0;return r?u=arguments[0]:(u={},u[arguments[0]]=arguments[1]),t.forEach(function(e){a[e]=[]}),new Promise(function(n,o){var i=void 0;try{i=e.database.transaction(t,p)}catch(f){return void("NotFoundError"===f.name?!function(){var r={};t.forEach(function(t){var n=e.get(t,u[t]);r[t]=n}),d["default"].all(r).then(n)["catch"](o)}():o(f))}i.oncomplete=i.onerror=i.onabort=function(e){var i=s||e.target.error,u=!i&&"complete"===e.type;u?n(r?a:a[t[0]]):o((0,v.ensureError)(i)),"error"===e.type&&e.preventDefault()};var l=function(e){var r=i.objectStore(e),t=u[e]||{},n=t.direction||b.ASC,o=t.range instanceof window.IDBKeyRange?t.range:null,d=!1,f=void 0;if(m&&(d=Object.keys(t).every(function(e){return"index"!==e&&"direction"!==e})),t.index){if(!r.indexNames.contains(t.index))return s=(0,v.createError)("NotFoundError","Object store "+r.name+" doesn't contain \""+t.index+'" index'),{v:void 0};try{f=r.index(t.index).openCursor(o,n)}catch(l){return s=l,{v:void 0}}}else if(d){var p=function(){var n=[o],i=0;t.limit&&(n.push(t.limit),t.offset&&(n[1]+=t.offset,i=t.offset));try{r.getAll.apply(r,n).onsuccess=function(r){var t=r.target.result;t.forEach(function(r,t){if(!(i>t)){var n=t-i;a[e][n]=a[e][n]||{},a[e][n].value=r}})},r.getAllKeys.apply(r,n).onsuccess=function(r){var t=r.target.result;t.forEach(function(r,t){if(!(i>t)){var n=t-i;a[e][n]=a[e][n]||{},a[e][n].key=r}})}}catch(u){s=u}finally{return{v:"continue"}}}();if("object"===("undefined"==typeof p?"undefined":c(p)))return p.v}else try{f=r.openCursor(o,n)}catch(l){return s=l,{v:void 0}}var y=!1;f.onsuccess=function(r){var n=r.target.result;if(n){if(t.offset&&!y)return y=!0,void n.advance(t.offset);a[e].push({key:n.key,value:n.value}),t.limit&&t.limit===a[e].length||n["continue"]()}}};for(var y in u){var h=l(y);switch(h){case"continue":continue;default:if("object"===("undefined"==typeof h?"undefined":c(h)))return h.v}}})},count:function(){var e=this,r=1===arguments.length&&"object"===c(arguments[0]),t=r?Object.keys(arguments[0]):[arguments[0]],n=void 0;r?n=arguments[0]:(n={},n[arguments[0]]="function"==typeof arguments[1]?null:arguments[1]);var o=i.call(this,t);if(!o){var a=(0,v.createError)("NotFoundError","Database "+this.database.name+" (version "+this.database.version+") doesn't contain all needed stores");return Promise.reject(a)}return new Promise(function(o,a){var i={},u=void 0,s=void 0,f=void 0;try{u=e.database.transaction(t,p)}catch(l){return void("NotFoundError"===l.name?!function(){var r={};t.forEach(function(t){var o=e.count(t,n[t]);r[t]=o}),d["default"].all(r).then(o)["catch"](a)}():a(l))}u.oncomplete=u.onerror=u.onabort=function(e){var n=f||e.target.error,u=!n&&"complete"===e.type;u?o(r?i:i[t[0]]):a((0,v.ensureError)(n)),"error"===e.type&&e.preventDefault()};var y=function(e){var r=u.objectStore(e),t=n[e]||{},o=t.range instanceof window.IDBKeyRange?[t.range]:[];if(t.index){if(!r.indexNames.contains(t.index))return f=(0,v.createError)("NotFoundError","Object store "+r.name+" doesn't contain \""+t.index+'" index'),{v:void 0};try{var a=r.index(t.index);s=a.count.apply(a,o)}catch(c){return f=c,{v:void 0}}}else try{s=r.count.apply(r,o)}catch(c){return f=c,{v:void 0}}s.onsuccess=function(r){i[e]=r.target.result||0}};for(var b in n){var h=y(b);if("object"===("undefined"==typeof h?"undefined":c(h)))return h.v}})},close:function(){this.database.close(),delete this.database}};b.open=function(e){var r=arguments.length<=1||void 0===arguments[1]?{version:1}:arguments[1];return new Promise(function(t,n){if(!window.indexedDB)return void n((0,v.createError)("NotSupportedError","Your browser doesn't support IndexedDB"));var o=window.indexedDB.open(e,r.version),a=!1;o.onupgradeneeded=function(e){if(!a){r.migration=r.migration||{};for(var t=e.oldVersion+1;t<=e.newVersion;t++)r.migration[t]&&r.migration[t].call(this,this.result)}},o.onerror=function(e){a||(e.preventDefault(),n((0,v.ensureError)(e.target.error)),a=!0)},o.onsuccess=function(i){if(!a){var u=this.result,c=parseInt(u.version||0,10);if("function"==typeof u.setVersion&&c<r.version){var s=u.setVersion(r.version);return s.onsuccess=function(a){var i=new Event("upgradeneeded");i.oldVersion=c,i.newVersion=r.version,o.onupgradeneeded.call({result:a.target.source},i),u.close(),b.open(e,r).then(t,n)},void(s.onerror=function(e){var r=e.target.errorMessage||e.target.webkitErrorMessage||e.target.mozErrorMessage||e.target.msErrorMessage||e.target.error.name;n((0,v.ensureError)(r))})}w.set(e,new Map),t(Object.create(g,{database:{configurable:!0,enumerable:!1,value:u,writable:!1}})),a=!0}},o.onblocked=function(r){a||(r.preventDefault(),n((0,v.createError)("InvalidStateError","Database "+e+" is blocked")),a=!0)}})},b.deleteDatabase=function(e){return new Promise(function(r,t){if(!window.indexedDB)return void t((0,v.createError)("NotSupportedError","Your browser doesn't support IndexedDB"));var n=window.indexedDB.deleteDatabase(e);n.onsuccess=n.onerror=n.onblocked=function(n){var o="blocked"===n.type?(0,v.createError)("InvalidStateError","Database "+e+" is blocked"):n.target.error;o?t((0,v.ensureError)(o)):r(),"success"!==n.type&&n.preventDefault()}})},b.keyValue=function(e,r){return Object.create(E,{key:{value:e,configurable:!1,writable:!1},value:{value:r,configurable:!1,writable:!1}})},r["default"]=b,e.exports=r["default"]},function(e,r){"use strict";function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function o(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}function a(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();Object.defineProperty(r,"__esModule",{value:!0});var c=function(e){function r(){return t(this,r),n(this,Object.getPrototypeOf(r).apply(this,arguments))}return o(r,e),u(r,[{key:"spread",value:function(e,r){function t(r){return Array.isArray(r)?e.apply(void 0,a(r)):void 0}return this.then(t,r)}}]),r}(Promise);c.all=function(e){return arguments.length>1||"object"!==("undefined"==typeof e?"undefined":i(e))?Promise.all.apply(Promise,arguments):new c(function(r,t){var n=Array.isArray(e),o=void 0,a=void 0;n?o=e:(a=Object.keys(e),o=a.map(function(r){return e[r]})),Promise.all(o).then(function(e){var t=void 0;t=n?e:e.reduce(function(e,r,t){return e[a[t]]=r,e},{}),r(t)})["catch"](t)})},r["default"]=c,e.exports=r["default"]},function(e,r){"use strict";function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=16*Math.random()|0,t="x"===e?r:3&r|8;return t.toString(16)})}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=t,e.exports=r["default"]},function(e,r){"use strict";function t(e,r){var t=new Error(r);return t.name=e,t}function n(e){return e instanceof Error?e:t(e.name,e.message)}Object.defineProperty(r,"__esModule",{value:!0}),r.createError=t,r.ensureError=n}])});
//# sourceMappingURL=sklad.min.js.map